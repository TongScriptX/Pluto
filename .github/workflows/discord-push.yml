name: 🔔 Discord Commit Notification (No Embed)

on:
  push:
    paths-ignore:
      - '.github/**'

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Extract changed filenames
        id: files
        run: |
          names=$(git diff --name-only HEAD^ HEAD | xargs -n1 basename | paste -sd ', ' -)
          echo "list=$names" >> $GITHUB_OUTPUT

      - name: Send plain message to Discord
        uses: hugoalh/send-discord-webhook-ghaction@v7.0.0
        with:
          key: ${{ secrets.DISCORD_GITHUB_UPDATE }}
          content: |
            🔔 新提交到 Pluto
            信息：`${{ github.event.head_commit.message }}`
            修改文件：`${{ steps.files.outputs.list }}`